<!DOCTYPE html>
<html>
<head>
<title>Tupi.web</title>

<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="style.css">
<script src="jquery-1.4.2.min.js"></script>
<script src="include.js"></script>
<script>

var gManifestName = "/manifest.webapp";

$(document).ready(function() {
  var request = navigator.mozApps.getSelf();
	request.onsuccess = function() {
	  if (request.result) {
	    // we're installed
	    $("#install_button").text("INSTALLED!").show();
	  } else {
	    // not installed
	    $("#install_button").show();
            $("#install_button").click(function() {
		var req = navigator.mozApps.install(gManifestName);
		req.onsuccess = function() {
                    $("#install_button").text("INSTALLED!").unbind('click');
                }
		req.onerror = function(errObj) {
                    alert("Couldn't install (" + errObj.code + ") " + errObj.message);
                }
            });
	  }
	}
	request.onerror = function() {
	  alert('Error checking installation status: ' + this.error.message);
	}
});

</script>

<script src="paper.js"></script>
<script type="text/paperscript" canvas="canvas">
		// Adapted from the following Processing example:
		// http://processing.org/learning/topics/follow3.html

		var isMouseDown = false;
		var paths = []; 
		var path = new Path();
		path.style = {
			strokeColor: '#E4141B',
			strokeWidth: 5,
			strokeCap: 'round'
		};
		var size = 25;
		var segments = path.segments;
		var start = view.center / [10, 1];
		//for (var i = 0; i < size; i++)
		//	path.add(start + new Point(i * 100, 0));

		function onMouseMove(event) {
			if(isMouseDown)
				path.add(event.point);
			//segments[0].point = event.point;
			//for (var i = 0; i < size - 1; i++) {
			//	var nextSegment = segments[i + 1];
			//	var position = path.segments[i].point;
			//	var angle = (position - nextSegment.point).angle;
			//	var vector = new Point({ angle: angle, length: 35 });
			//	nextSegment.point = position - vector;
			// }
			//path.smooth();
		}

		function onMouseDown(event) {
			//path.smooth();
			isMouseDown = true;
			path.add(event.point);
			//path.fullySelected = true;
			//path.strokeColor = '#e08285';			
		}

		function onMouseUp(event) {
			isMouseDown = false;
			path.fullySelected = false;
			path.strokeColor = '#e4141b';
		}
	</script>
</head>
<body>
 <div id="test">
	<canvas id="canvas" resize></canvas>
 <div>
</body>
</html>
